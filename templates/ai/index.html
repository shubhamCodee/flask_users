{% extends "base.html" %}

{% block content %}

    <!-- HEADER -->
    <div class="flex justify-between items-end mb-6">
        <h1 class="text-3xl font-bold text-primary">Intelligence Hub</h1>
        
        <form action="{{ url_for('ai.train') }}" method="POST">
            <button type="submit" class="bg-[#1A1A1A] border border-darkgray text-secondary px-4 py-2 rounded hover:text-white transition-colors text-xs uppercase tracking-widest">
                Retrain Brain
            </button>
        </form>
    </div>

    <!-- CHAT WINDOW -->
    <div class="bg-[#121212] border border-darkgray rounded-lg shadow-2xl overflow-hidden flex flex-col h-[600px]">
        
        <!-- Messages Area -->
        <div class="flex-1 overflow-y-auto p-6 space-y-6">
            
            {% if message %}
                <div class="text-center">
                    <span class="bg-green-900/20 text-green-400 px-3 py-1 rounded text-xs font-mono border border-green-900">
                        System: {{ message }}
                    </span>
                </div>
            {% endif %}

            {% if answer %}
                
                <!-- User -->
                <div class="flex justify-end">
                    <div class="bg-darkgray text-primary px-5 py-3 rounded-2xl rounded-tr-none max-w-[80%]">
                        {{ query }}
                    </div>
                </div>

                <!-- System -->
                <div class="flex justify-start">
                    <!-- 'prose-invert' makes the HTML generated by Python look good automatically -->
                    <div class="bg-[#1A1A1A] border border-darkgray text-secondary px-6 py-5 rounded-2xl rounded-tl-none max-w-[90%] prose prose-invert prose-sm">
                        {{ answer | safe }}
                    </div>
                </div>

            {% else %}
                
                <!-- Empty State -->
                <div class="h-full flex flex-col items-center justify-center opacity-40">
                    <div class="text-6xl mb-4 text-darkgray">â—ˆ</div>
                    <h3 class="text-xl text-primary">Ready</h3>
                </div>

            {% endif %}

        </div>

        <!-- Input -->
        <div class="bg-[#1A1A1A] border-t border-darkgray p-4">
            <form action="{{ url_for('ai.ask') }}" method="POST" class="relative">
                <input type="text" name="query" placeholder="Ask a question..." required autocomplete="off" autofocus
                       class="w-full bg-[#121212] border border-darkgray text-primary px-4 py-4 pr-24 rounded-lg focus:outline-none focus:border-softgray">
                
                <button type="submit" class="absolute right-2 top-2 bottom-2 bg-primary text-charcoal font-bold text-sm px-4 rounded hover:bg-white">
                    SEND
                </button>
            </form>
        </div>

    </div>

{% endblock %}