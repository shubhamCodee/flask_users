{% extends "base.html" %}

{% block content %}

    <div class="flex justify-between items-end mb-6">
        <div>
            <h1 class="text-3xl font-bold text-primary">Intelligence Hub</h1>
            <p class="text-secondary text-sm">Llama-3 Powered • Knowledge Context Active</p>
        </div>
        
        <form action="{{ url_for('ai.train') }}" method="POST">
            <button type="submit" 
                    class="bg-[#1A1A1A] border border-darkgray hover:border-red-800 text-secondary hover:text-red-400 text-xs uppercase tracking-widest px-4 py-2 rounded transition-all flex items-center gap-2">
                <span class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></span>
                Retrain Brain
            </button>
        </form>
    </div>

    <div class="bg-[#121212] border border-darkgray rounded-lg shadow-2xl overflow-hidden flex flex-col h-[600px] relative">
        
        <div class="flex-1 overflow-y-auto p-6 space-y-6" id="chat-container">
            
            {% if message %}
                <div class="flex justify-center">
                    <div class="bg-green-900/20 border border-green-800 text-green-400 text-xs font-mono py-2 px-4 rounded-full">
                        System: {{ message }}
                    </div>
                </div>
            {% endif %}

            {% if answer %}
                
                <div class="flex justify-end">
                    <div class="max-w-[80%]">
                        <div class="bg-darkgray text-primary px-5 py-3 rounded-2xl rounded-tr-none text-right shadow-sm">
                            {{ query }}
                        </div>
                        <span class="text-[10px] text-softgray uppercase tracking-widest mt-1 block text-right">You</span>
                    </div>
                </div>

                <div class="flex justify-start">
                    <div class="max-w-[85%]">
                        <div class="bg-[#1A1A1A] border border-darkgray text-secondary px-6 py-4 rounded-2xl rounded-tl-none shadow-sm leading-relaxed whitespace-pre-line">
                            {{ answer }}
                        </div>
                        <span class="text-[10px] text-softgray uppercase tracking-widest mt-1 block">System</span>
                    </div>
                </div>

            {% else %}
                
                <div class="h-full flex flex-col items-center justify-center text-center opacity-40">
                    <div class="text-6xl mb-4 text-darkgray">◈</div>
                    <h3 class="text-xl font-light text-primary">Awaiting Input</h3>
                    <p class="text-sm text-secondary mt-2">Ask about Deals, Revenue, or Staff.</p>
                </div>

            {% endif %}

        </div>

        <div class="bg-[#1A1A1A] border-t border-darkgray p-4">
            <form action="{{ url_for('ai.ask') }}" method="POST" class="relative">
                <input type="text" 
                       name="query" 
                       placeholder="Enter command or question..." 
                       required
                       autocomplete="off"
                       autofocus
                       class="w-full bg-[#121212] border border-darkgray text-primary placeholder-darkgray px-4 py-4 pr-24 rounded-lg focus:outline-none focus:border-softgray transition-colors font-light">
                
                <button type="submit" 
                        class="absolute right-2 top-2 bottom-2 bg-primary hover:bg-white text-charcoal font-bold text-sm px-4 rounded transition-colors">
                    SEND
                </button>
            </form>
        </div>

    </div>

{% endblock %}